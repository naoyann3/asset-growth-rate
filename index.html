<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ä¸»è¦è³‡ç”£ å††å»ºã¦è©•ä¾¡é¡æ¨ç§» (2021-2025)</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@500;700&display=swap" rel="stylesheet">
<style>
  body { font-family: 'Noto Sans JP', sans-serif; background:#f3f4f6; }
  .card { background:white; border-radius:16px; box-shadow:0 4px 6px -1px rgba(0,0,0,0.1); padding:24px; margin-bottom:24px; }
  .year-btn {
    @apply px-5 py-2 rounded-full font-bold text-sm transition-all border shadow-sm bg-white text-slate-600 border-slate-300 hover:bg-slate-50;
  }
  .year-btn.active {
    @apply bg-indigo-600 text-white border-indigo-600 shadow-md;
  }
  /* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ */
  .asset-checkbox:checked + label {
    background-color: var(--active-color);
    color: white !important;
    border-color: var(--active-color);
  }
  .asset-checkbox:checked + label svg { transform: scale(1); }
  .asset-checkbox:checked + label .check-circle { border-color: white; }
</style>
</head>
<body class="p-4 md:p-10 text-slate-800">

<div class="max-w-7xl mx-auto">

  <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
  <div class="bg-indigo-900 text-white p-8 rounded-2xl shadow-lg mb-8 text-center">
    <h1 class="text-3xl md:text-5xl font-bold mb-2">ğŸ“ˆ ä¸»è¦è³‡ç”£ å††å»ºã¦è©•ä¾¡é¡æ¨ç§»</h1>
    <p class="text-indigo-200">2021å¹´1æœˆã« <span class="text-white font-bold text-lg">100ä¸‡å††</span> æŠ•è³‡ã—ãŸå ´åˆã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</p>
    <p class="text-xs text-indigo-400 mt-2">â€»ãƒ‰ãƒ«å»ºã¦è³‡ç”£ã¯å½“æ™‚ã®ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆ(USD/JPY)ã§å††æ›ç®—æ¸ˆã¿</p>
  </div>

  <!-- ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ‘ãƒãƒ« -->
  <div class="card">
    <h3 class="font-bold text-sm uppercase text-slate-400 mb-4 border-b pb-2">è¡¨ç¤ºã‚¢ã‚»ãƒƒãƒˆã‚’é¸æŠ</h3>
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4">
      <div>
        <p class="text-xs font-bold text-slate-500 mb-2">ğŸª™ æš—å·è³‡ç”£</p>
        <div id="crypto-assets" class="space-y-2"></div>
      </div>
      <div>
        <p class="text-xs font-bold text-slate-500 mb-2">ğŸ“± ç±³å›½æ ª (GAFAM+)</p>
        <div id="stock-assets" class="space-y-2"></div>
      </div>
      <div>
        <p class="text-xs font-bold text-slate-500 mb-2">ğŸ“Š æŒ‡æ•°</p>
        <div id="index-assets" class="space-y-2"></div>
      </div>
      <div>
        <p class="text-xs font-bold text-slate-500 mb-2">ğŸ’ ã‚³ãƒ¢ãƒ‡ã‚£ãƒ†ã‚£</p>
        <div id="commodity-assets" class="space-y-2"></div>
      </div>
    </div>
  </div>

  <!-- ãƒãƒ£ãƒ¼ãƒˆã‚¨ãƒªã‚¢ -->
  <div class="card">
    <div class="flex flex-wrap gap-2 justify-center mb-6">
      <button class="year-btn active" data-period="all">å…¨æœŸé–“</button>
      <button class="year-btn" data-period="2021">2021</button>
      <button class="year-btn" data-period="2022">2022</button>
      <button class="year-btn" data-period="2023">2023</button>
      <button class="year-btn" data-period="2024">2024</button>
      <button class="year-btn" data-period="2025">2025</button>
    </div>

    <div class="h-[500px] md:h-[700px] w-full relative">
      <canvas id="chart"></canvas>
    </div>
    <p class="text-right text-xs text-slate-400 mt-2">â€»ãƒ‡ãƒ¼ã‚¿æœŸé–“: 2021å¹´1æœˆã€œ2025å¹´11æœˆ</p>
  </div>
</div>

<script>
Chart.register(ChartDataLabels);

// --- 1. ãƒ‡ãƒ¼ã‚¿å®šç¾© (æä¾›ãƒ‡ãƒ¼ã‚¿ã‚’æ˜‡é †ã«æ•´ç†) ---

// ãƒ©ãƒ™ãƒ« (2021-01 ~ 2025-11)
const labels = [];
for(let y=2021; y<=2025; y++) for(let m=1; m<=12; m++) { 
    if(y===2025 && m>11) break; // 2025å¹´11æœˆã¾ã§
    labels.push(`${y}-${String(m).padStart(2,'0')}`); 
}

// USD/JPY (2021/01 - 2025/11)
const usdJpy = [
    104.73, 106.57, 110.73, 109.32, 109.60, 111.10, 109.68, 109.99, 111.26, 114.00, 113.01, 115.07,
    115.08, 114.95, 121.69, 130.84, 128.70, 135.76, 133.23, 138.95, 144.75, 148.74, 137.97, 131.20,
    130.14, 136.18, 132.82, 136.30, 139.33, 144.32, 142.25, 145.53, 149.34, 151.70, 148.26, 141.04,
    147.24, 149.92, 151.34, 157.72, 157.28, 160.89, 149.88, 146.17, 143.59, 152.08, 149.77, 157.20,
    155.20, 150.62, 149.91, 142.96, 144.04, 144.03, 150.71, 147.86, 147.86, 153.99, 156.18
];

// ç”Ÿãƒ‡ãƒ¼ã‚¿ (æ˜‡é †)
const raw = {
    BTC: [33108, 45164, 58763, 57720, 37298, 35026, 41553, 47130, 43823, 61309, 56882, 46219, 38498, 43188, 45525, 37650, 31793, 19926, 23303, 20043, 19423, 20496, 17163, 16537, 23125, 23130, 28473, 29252, 27216, 30472, 29232, 25937, 26962, 34650, 37712, 42272, 42580, 61169, 71332, 60666, 67530, 62754, 64626, 58978, 63339, 70281, 96405, 93557, 94536, 84381, 82548, 94184, 104598, 107171, 115765, 108226, 114048, 109602, 90374],
    ETH: [1312, 1418, 1917, 2772, 2708, 2273, 2532, 3430, 3000, 4287, 4628, 3677, 2686, 2922, 3282, 2727, 1941, 1069, 1680, 1555, 1328, 1572, 1294, 1195, 1585, 1604, 1821, 1868, 1873, 1933, 1856, 1645, 1670, 1815, 2051, 2281, 2283, 3339, 3647, 3014, 3762, 3437, 3231, 2513, 2603, 2519, 3702, 3337, 3298, 2236, 1821, 1793, 2528, 2486, 3698, 4391, 4144, 3848, 2991],
    BNB: [44, 210, 302, 623, 353, 303, 332, 464, 387, 524, 623, 511, 374, 395, 428, 377, 320, 219, 283, 279, 284, 325, 300, 246, 312, 301, 317, 337, 306, 240, 240, 216, 214, 226, 227, 312, 300, 399, 606, 578, 593, 582, 576, 532, 567, 576, 653, 702, 677, 587, 604, 599, 657, 656, 783, 857, 1008, 1088, 875],
    NVIDIA: [519.60, 548.60, 533.92, 600.40, 649.80, 800.12, 19.49, 223.85, 207.16, 255.67, 326.76, 294.11, 244.86, 243.85, 272.86, 185.47, 187.60, 151.59, 181.63, 150.94, 121.39, 134.97, 169.23, 146.14, 195.37, 232.16, 277.77, 277.49, 378.34, 423.02, 467.29, 493.55, 434.99, 407.80, 467.70, 495.22, 615.27, 791.12, 903.56, 864.02, 1096.33, 123.54, 117.02, 119.37, 121.44, 132.76, 138.25, 134.29, 120.07, 124.92, 108.38, 108.92, 135.13, 157.99, 177.87, 174.18, 186.58, 202.49, 177.00],
    AAPL: [131.96, 121.26, 122.15, 131.46, 124.61, 136.96, 145.86, 151.83, 141.50, 149.80, 165.30, 177.57, 174.78, 165.12, 174.61, 157.65, 149.30, 136.72, 162.51, 157.22, 138.20, 153.34, 148.03, 129.93, 144.29, 147.41, 164.90, 169.68, 177.25, 193.97, 196.45, 187.87, 171.21, 170.77, 189.95, 192.53, 184.40, 180.75, 171.48, 170.33, 192.25, 210.62, 222.08, 229.00, 233.00, 225.91, 237.33, 250.42, 236.00, 241.84, 222.13, 212.50, 200.85, 205.17, 207.57, 232.14, 254.63, 270.37, 278.85],
    GOOGLE: [1827.36, 2021.91, 2062.52, 2353.50, 2356.85, 2441.79, 2694.53, 2893.95, 2673.52, 2960.92, 2837.95, 2897.04, 2706.07, 2701.14, 2781.35, 2282.19, 2286.64, 2179.26, 116.32, 108.22, 95.65, 94.51, 100.99, 88.23, 98.84, 90.06, 103.73, 107.34, 122.87, 119.70, 132.72, 136.17, 130.86, 124.08, 132.53, 139.69, 140.10, 138.46, 150.93, 162.78, 172.50, 182.15, 171.54, 163.38, 165.85, 171.11, 168.95, 189.30, 204.02, 170.28, 154.64, 158.80, 171.74, 176.23, 191.90, 212.91, 243.10, 281.19, 320.18],
    AMAZON: [160.6, 155.9, 154.7, 173.3, 161.1, 172.0, 166.3, 173.5, 166.2, 168.6, 175.3, 166.7, 149.5, 153.5, 162.9, 124.2, 120.2, 106.2, 134.9, 126.7, 113.0, 103.4, 96.5, 84.0, 103.1, 94.2, 103.2, 105.4, 120.5, 130.3, 133.6, 138.0, 127.1, 133.0, 146.0, 151.9, 155.2, 176.7, 180.3, 175.0, 181.0, 193.3, 186.7, 178.5, 195.3, 202.4, 219.7, 250.4, 245.5, 232.6, 219.2, 223.7, 218.5, 206.7, 186.6, 173.7, 176.2, 166.2, 159.1],
    'S&P 500': [13641,14043,15142,15861,15975,16444,16777,17277,16951,18163,18432,19204,17837,17684,19683,18851,18669,18301,19236,19417,18548,20365,19380,18035,18524,19213,19167,19670,20875,22664,22984,23519,22940,22238,23926,24281,26026,27391,28559,28832,29510,31789,29851,29198,29562,32262,32695,34182,33955,31801,30280,28788,30919,32527,34608,34812,36175,38371,38984],
    'æ—¥çµŒå¹³å‡': [27663,28966,29178,28812,28860,28791,27283,28089,29452,28892,27821,28791,27001,26526,27821,26847,27279,26393,27801,28091,25937,27587,27968,26094,27327,27445,28041,28856,30887,33189,33172,32619,31857,30858,33486,33464,36286,39166,40369,38405,38487,39583,39101,38647,37919,39081,38208,39894,39572,37155,35617,36045,37965,40487,41069,42718,44932,52411,50253],
    GOLD: [6276,6199,6066,6195,6549,6554,6450,6369,6368,6495,6728,6580,6755,6913,7464,7901,7695,7954,7699,7721,7794,7920,7944,7854,8024,7990,8249,8620,8822,8871,8879,8988,9155,9246,9604,9486,9622,9779,10428,11561,11880,11859,12185,11675,11863,12978,13155,13082,13676,14169,14298,14996,15349,15638,15832,16020,17429,19828,20454],
    SILVER: [88.8,96.0,93.0,93.0,100.1,99.0,94.8,88.2,86.3,87.7,92.0,84.8,88.7,89.7,99.1,102.9,93.4,95.6,86.6,89.0,89.4,93.7,98.2,103.3,101.8,96.6,96.4,109.3,108.9,108.7,111.2,112.2,113.1,110.3,115.8,114.7,110.9,112.0,120.2,137.8,151.3,153.2,154.5,137.9,141.0,158.9,156.5,154.1,156.2,160.3,162.1,153.4,156.3,169.8,180.6,183.7,204.6,243.2,256.6]
};

// 2. ã‚¢ã‚»ãƒƒãƒˆè¨­å®š
const assets = {
  BTC:    { name:"Bitcoin",  col:"#F7931A", cat:"crypto", curr: 'USD' },
  ETH:    { name:"Ethereum", col:"#627EEA", cat:"crypto", curr: 'USD' },
  BNB:    { name:"BNB",      col:"#F3BA2F", cat:"crypto", curr: 'USD' },
  NVIDIA: { name:"NVIDIA",   col:"#76B900", cat:"stock",  curr: 'USD' },
  AAPL:   { name:"Apple",    col:"#555555", cat:"stock",  curr: 'USD' },
  AMAZON: { name:"Amazon",   col:"#14B8A6", cat:"stock",  curr: 'USD' },
  GOOGLE: { name:"Google",   col:"#4285F4", cat:"stock",  curr: 'USD' },
  'S&P 500':{ name:"S&P 500 (å††)",col:"#3B82F6", cat:"index", curr: 'JPY' },
  'æ—¥çµŒå¹³å‡':{ name:"æ—¥çµŒå¹³å‡",col:"#DC2626", cat:"index", curr: 'JPY' },
  GOLD:   { name:"Gold",     col:"#D4AF37", cat:"commodity", curr: 'JPY' },
  SILVER: { name:"Silver",   col:"#94A3B8", cat:"commodity", curr: 'JPY' }
};

// 3. ãƒ‡ãƒ¼ã‚¿å‡¦ç† (å††å»ºã¦è³‡ç”£é¡ã¸ã®å¤‰æ›: åˆæœŸ100ä¸‡å††)
const jpyValues = {};
const INITIAL_INVESTMENT = 1000000; // 100ä¸‡å††

Object.keys(assets).forEach(k => {
  let prices = [...raw[k]];
  let values = [];
  
  // JPYè³‡ç”£ï¼ˆã¾ãŸã¯æ—¢ã«å††æ›ç®—æ¸ˆã¿ã®æŒ‡æ•°ï¼‰
  if (assets[k].curr === 'JPY' || k === 'S&P 500' || k === 'S&P 500 (å††)') {
     const initialPrice = prices[0];
     values = prices.map(p => Math.round((p / initialPrice) * INITIAL_INVESTMENT));
  } 
  // USDè³‡ç”£ï¼ˆç‚ºæ›¿ã¨åˆ†å‰²ã‚’è€ƒæ…®ï¼‰
  else {
    values = prices.map((price, i) => {
      let multiplier = 1;
      
      // æ ªå¼åˆ†å‰²èª¿æ•´ (ä¿æœ‰æ ªæ•°ã‚’å¢—ã‚„ã™)
      if (k === "NVIDIA") {
        if (i >= 41) multiplier = 40; // 2024-06ä»¥é™: 1:4 * 1:10 = 40å€
        else if (i >= 6) multiplier = 4; // 2021-07ä»¥é™: 1:4 = 4å€
      } else if (k === "GOOGLE") {
         if (i >= 18) multiplier = 20; // 2022-07ä»¥é™: 1:20 = 20å€
      }
      
      // åˆæœŸ(i=0)æ™‚ç‚¹ã§ã®è³¼å…¥å£æ•°ã‚’è¨ˆç®—
      // åˆæœŸä¾¡æ ¼(ãƒ‰ãƒ«) * åˆæœŸãƒ¬ãƒ¼ãƒˆ(å††) ã§1å˜ä½ã‚ãŸã‚Šã®å††ä¾¡æ ¼ã‚’å‡ºã—ã€100ä¸‡å††ã§å‰²ã‚‹
      const initialPriceYen = prices[0] * usdJpy[0]; 
      const units = INITIAL_INVESTMENT / initialPriceYen; 
      
      return Math.round(price * multiplier * units * usdJpy[i]);
    });
  }
  jpyValues[k] = values;
});

// 4. ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ç”Ÿæˆ
Object.keys(assets).forEach(k => {
  const a = assets[k];
  const container = document.getElementById(a.cat + '-assets');
  if (container) {
      // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ONã«ã™ã‚‹éŠ˜æŸ„
      const defaultChecked = ['BTC', 'NVIDIA', 'GOLD', 'S&P 500'].includes(k) ? 'checked' : '';
      
      container.innerHTML += `
      <div class="flex items-center">
        <input type="checkbox" id="cb-${k.replace(/\s/g, '')}" class="hidden asset-checkbox" 
               onchange="updateChart()" data-key="${k}" ${defaultChecked}
               style="--active-color: ${a.col}">
        <label for="cb-${k.replace(/\s/g, '')}" class="flex items-center cursor-pointer p-2 rounded-lg w-full border-2 border-slate-200 transition hover:bg-slate-50 text-slate-600">
            <div class="check-circle w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center transition" style="border-color: ${a.col}">
                 <svg class="w-3 h-3 text-white transform scale-0 transition-transform" fill="currentColor" viewBox="0 0 20 20"><path d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"></path></svg>
            </div>
            <span class="font-bold">${a.name}</span>
        </label>
      </div>`;
  }
});

// 5. ãƒãƒ£ãƒ¼ãƒˆæç”»
let chart, currentPeriod = 'all';

function updateChart() {
  const checked = Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(c => c.dataset.key);
  
  // æœŸé–“ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
  let startIdx = 0;
  let endIdx = labels.length;
  
  if (currentPeriod !== 'all') {
    const yearStr = currentPeriod;
    startIdx = labels.findIndex(l => l.startsWith(yearStr));
    endIdx = labels.findLastIndex(l => l.startsWith(yearStr)) + 1;
  }

  // ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆ(startIdx=-1)ã®ã‚¬ãƒ¼ãƒ‰
  if (startIdx === -1) { startIdx = 0; endIdx = 0; }

  const subLabels = labels.slice(startIdx, endIdx);

  chart.data.labels = subLabels;
  chart.data.datasets = checked.map(key => {
    const dataSlice = jpyValues[key].slice(startIdx, endIdx);
    return {
      label: assets[key].name,
      data: dataSlice,
      borderColor: assets[key].col,
      backgroundColor: assets[key].col + '33',
      borderWidth: 2.5,
      pointRadius: 0,
      pointHitRadius: 20,
      tension: 0.2,
      assetKey: key // ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ç”¨ID
    };
  });
  
  // Xè»¸ã®å˜ä½èª¿æ•´
  chart.options.scales.x.time.unit = (currentPeriod === 'all') ? 'year' : 'month';
  
  chart.update();
}

// æœŸé–“ãƒœã‚¿ãƒ³
document.querySelectorAll('.year-btn').forEach(btn => {
  btn.addEventListener('click', function() {
    document.querySelectorAll('.year-btn').forEach(b => b.classList.remove('active', 'bg-indigo-600', 'text-white', 'shadow-md'));
    document.querySelectorAll('.year-btn').forEach(b => b.classList.add('bg-white', 'text-slate-600', 'hover:bg-slate-100'));
    
    this.classList.remove('bg-white', 'text-slate-600', 'hover:bg-slate-100');
    this.classList.add('active', 'bg-indigo-600', 'text-white', 'shadow-md');
    
    currentPeriod = this.dataset.period;
    updateChart();
  });
});

// ãƒãƒ£ãƒ¼ãƒˆåˆæœŸåŒ–
const ctx = document.getElementById('chart').getContext('2d');
chart = new Chart(ctx, {
  type: 'line',
  data: { labels: [], datasets: [] },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    interaction: { mode: 'index', intersect: false },
    layout: { padding: { right: 40 } },
    plugins: {
      legend: { 
          display: true, 
          position: 'top',
          labels: { usePointStyle: true, padding: 20, font: { weight: 'bold' } },
          onClick: (e, legendItem, legend) => {
              // å‡¡ä¾‹ã‚¯ãƒªãƒƒã‚¯ã§è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆï¼ˆãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã¨ã‚‚é€£å‹•ã•ã›ã‚‹ã¨ãªãŠè‰¯ã„ãŒç°¡æ˜“å®Ÿè£…ï¼‰
              const index = legendItem.datasetIndex;
              const ci = legend.chart;
              if (ci.isDatasetVisible(index)) {
                  ci.hide(index);
                  legendItem.hidden = true;
              } else {
                  ci.show(index);
                  legendItem.hidden = false;
              }
          }
      },
      tooltip: {
        callbacks: {
          label: function(context) {
            const val = context.raw;
            const diff = val - 1000000;
            const sign = diff >= 0 ? '+' : '';
            const percent = ((val / 1000000 - 1) * 100).toFixed(1);
            return `${context.dataset.label}: ${Math.round(val).toLocaleString()}å†† (${sign}${percent}%)`;
          }
        }
      },
      datalabels: {
        align: 'right',
        anchor: 'end',
        color: c => c.dataset.borderColor,
        font: { weight: 'bold', size: 11 },
        formatter: (v, c) => {
             return c.dataIndex === c.dataset.data.length - 1 ? c.dataset.label : null;
        },
        display: 'auto',
        clip: false
      }
    },
    scales: {
      x: { 
          type: 'time',
          time: { unit: 'year', displayFormats: { 'year': 'yyyyå¹´', 'month': 'Mæœˆ'} },
          grid: { color: '#e2e8f0' }, 
          ticks: { color: '#475569', font: {weight: 'bold'} } 
      },
      y: {
        grid: { color: '#e2e8f0' },
        title: { display: true, text: 'è©•ä¾¡é¡ (å††)', font: { weight: 'bold' } },
        ticks: { 
            callback: v => (v/10000).toLocaleString() + 'ä¸‡å††',
            color: '#475569'
        }
      }
    }
  }
});

// ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†å¾Œã«åˆæœŸæç”»
window.onload = updateChart;
</script>
</body>
</html>
