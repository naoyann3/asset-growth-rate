<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ä¸»è¦è³‡ç”£ å††å»ºã¦è©•ä¾¡é¡ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@500;700&display=swap" rel="stylesheet">
<style>
  body { font-family: 'Noto Sans JP', sans-serif; background:#f3f4f6; }
  .card { background:white; border-radius:16px; box-shadow:0 4px 6px -1px rgba(0,0,0,0.1); padding:24px; margin-bottom:24px; }
  .year-btn {
    @apply px-5 py-2 rounded-full font-bold text-sm transition-all border shadow-sm bg-white text-slate-600 border-slate-300 hover:bg-slate-50;
  }
  .year-btn.active {
    @apply bg-indigo-600 text-white border-indigo-600 shadow-md;
  }
  /* ã‚«ã‚¹ã‚¿ãƒ ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ */
  .asset-label {
      border: 2px solid #e2e8f0;
      transition: all 0.2s;
  }
  .asset-checkbox:checked + .asset-label {
      background-color: var(--active-color);
      color: white !important;
      border-color: var(--active-color);
  }
  .asset-checkbox:checked + .asset-label svg { transform: scale(1); }
  .asset-checkbox:checked + .asset-label .check-circle { border-color: white; }
</style>
</head>
<body class="p-4 md:p-10 text-slate-800">

<div class="max-w-7xl mx-auto">

  <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
  <div class="bg-indigo-900 text-white p-8 rounded-2xl shadow-lg mb-8 text-center">
    <h1 class="text-3xl md:text-5xl font-bold mb-2">ğŸ“ˆ ä¸»è¦è³‡ç”£ å††å»ºã¦è©•ä¾¡é¡æ¨ç§»</h1>
    <p class="text-indigo-200">2021å¹´1æœˆã« <span class="text-white font-bold text-lg">100ä¸‡å††</span> æŠ•è³‡ã—ãŸå ´åˆã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</p>
  </div>

  <!-- ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ‘ãƒãƒ« -->
  <div class="card">
    <h3 class="font-bold text-sm uppercase text-slate-400 mb-4 border-b pb-2">è¡¨ç¤ºã‚¢ã‚»ãƒƒãƒˆã‚’é¸æŠ</h3>
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4">
      <div>
        <p class="text-xs font-bold text-slate-500 mb-2">ğŸª™ æš—å·è³‡ç”£</p>
        <div id="crypto-assets" class="space-y-2"></div>
      </div>
      <div>
        <p class="text-xs font-bold text-slate-500 mb-2">ğŸ“± ç±³å›½æ ª (GAFAM+)</p>
        <div id="stock-assets" class="space-y-2"></div>
      </div>
      <div>
        <p class="text-xs font-bold text-slate-500 mb-2">ğŸ“Š æŒ‡æ•°</p>
        <div id="index-assets" class="space-y-2"></div>
      </div>
      <div>
        <p class="text-xs font-bold text-slate-500 mb-2">ğŸ’ ã‚³ãƒ¢ãƒ‡ã‚£ãƒ†ã‚£</p>
        <div id="commodity-assets" class="space-y-2"></div>
      </div>
    </div>
  </div>

  <!-- ãƒãƒ£ãƒ¼ãƒˆã‚¨ãƒªã‚¢ -->
  <div class="card">
    <div class="flex flex-wrap gap-2 justify-center mb-6">
      <button class="year-btn active" data-period="all">å…¨æœŸé–“</button>
      <button class="year-btn" data-period="2021">2021</button>
      <button class="year-btn" data-period="2022">2022</button>
      <button class="year-btn" data-period="2023">2023</button>
      <button class="year-btn" data-period="2024">2024</button>
      <button class="year-btn" data-period="2025">2025</button>
    </div>

    <div class="h-[500px] md:h-[700px] w-full relative">
      <canvas id="chart"></canvas>
    </div>
    <p class="text-right text-xs text-slate-400 mt-2">â€»ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆ(USD/JPY)ã€æ ªå¼åˆ†å‰²ã‚’è€ƒæ…®ã—ãŸå††å»ºã¦è©•ä¾¡é¡</p>
  </div>
</div>

<script>
Chart.register(ChartDataLabels);

// --- ãƒ‡ãƒ¼ã‚¿å®šç¾© ---
const labels = [];
for(let y=2021; y<=2025; y++) for(let m=1; m<=12; m++) { if(y===2025&&m>11) break; labels.push(`${y}-${String(m).padStart(2,'0')}`); }

const usdJpy = [104.73,106.57,110.73,109.32,109.60,111.10,109.68,109.99,111.26,114.00,113.01,115.07,115.08,114.95,121.69,130.84,128.70,135.76,133.23,138.95,144.75,148.74,137.97,131.20,130.14,136.18,132.82,136.30,139.33,144.32,142.25,145.53,149.34,151.70,148.26,141.04,147.24,149.92,151.34,157.72,157.28,160.89,149.88,146.17,143.59,152.08,149.77,157.20,155.20,150.62,149.91,142.96,144.04,144.03,150.71,147.86,147.86,153.99,156.18];

const applePrices = [129.41,142.06,169.00,171.24,123.00,127.90,145.11,148.99,141.50,149.04,163.98,172.26,174.24,176.28,176.08,165.36,171.90,149.80,173.07,175.08,174.48,169.67,168.49,178.20,174.79,171.48,175.64,170.12,177.84,188.72,191.29,189.40,191.45,187.68,190.36,188.61,181.71,180.16,173.19,173.03,178.99,173.50,175.16,174.83,174.49,179.30,180.96,178.08,173.14,171.52,170.03,175.00,174.24,173.31,174.97,175.78,173.30,177.49,181.18,191.00];

const raw = {
  BTC:[33141,45247,58872,57723,37286,35041,41551,47137,43846,61322,57005,46319,38483,43193,45538,37714,31792,19986,23336,20049,19431,20496,17164,16547,23139,23145,28476,29227,27202,30477,29231,25936,26970,27814,37710,42266,42579,61189,71229,60666,67530,62754,64626,58978,63339,70281,96405,93557,94536,84381,82548,94184,104598,107171,115765,108226,114048,109602,90374],
  ETH:[1312,1418,1917,2772,2708,2273,2532,3430,3000,4287,4628,3677,2686,2922,3282,2727,1941,1069,1680,1555,1328,1572,1294,1195,1585,1604,1821,1868,1873,1933,1856,1645,1670,1815,2051,2281,2283,3339,3647,3014,3762,3437,3231,2513,2603,2519,3702,3337,3298,2236,1821,1793,2528,2486,3698,4391,4144,3848,2991],
  BNB:[44,210,302,623,353,303,332,464,387,524,623,511,374,395,428,377,320,219,283,279,284,325,300,246,312,301,317,337,306,240,240,216,214,226,227,312,300,399,606,578,593,582,576,532,567,576,653,702,677,587,604,599,657,656,783,857,1008,1088,875],
  NVIDIA:[130,137,133,150,162,200,195,224,207,256,327,294,245,244,273,185,188,152,182,151,121,135,169,146,195,232,278,277,378,423,467,494,435,408,468,495,615,791,904,864,1096,124,117,119,121,133,138,134,120,125,108,109,135,158,178,174,187,202,177],
  AAPL: applePrices,
  GOOGLE:[1827,2021,2062,2353,2356,2441,2694,2893,2673,2960,2837,2897,2706,2701,2781,2282,2286,2179,116,108,95,94,100,88,98,90,103,107,122,119,132,136,130,124,132,139,140,138,150,162,172,182,171,163,166,171,169,189,204,170,154,158,171,176,191,212,243,281,320],
  AMAZON:[160,155,154,173,161,172,166,173,166,169,175,166,149,153,162,124,120,106,134,126,113,103,96,84,103,94,103,105,120,130,133,138,127,133,146,151,155,176,180,175,181,193,186,178,195,202,219,250,245,232,219,223,218,206,186,173,176,166,159],
  'S&P 500':[13641,14043,15142,15861,15975,16444,16777,17277,16951,18163,18432,19204,17837,17684,19683,18851,18669,18301,19236,19417,18548,20365,19380,18035,18524,19213,19167,19670,20875,22664,22984,23519,22940,22238,23926,24281,26026,27391,28559,28832,29510,31789,29851,29198,29562,32262,32695,34182,33955,31801,30280,28788,30919,32527,34608,34812,36175,38371,38984],
  'æ—¥çµŒå¹³å‡':[27663,28966,29178,28812,28860,28791,27283,28089,29452,28892,27821,28791,27001,26526,27821,26847,27279,26393,27801,28091,25937,27587,27968,26094,27327,27445,28041,28856,30887,33189,33172,32619,31857,30858,33486,33464,36286,39166,40369,38405,38487,39583,39101,38647,37919,39081,38208,39894,39572,37155,35617,36045,37965,40487,41069,42718,44932,52411,50253],
  GOLD:[6276,6199,6066,6195,6549,6554,6450,6369,6368,6495,6728,6580,6755,6913,7464,7901,7695,7954,7699,7721,7794,7920,7944,7854,8024,7990,8249,8620,8822,8871,8879,8988,9155,9246,9604,9486,9622,9779,10428,11561,11880,11859,12185,11675,11863,12978,13155,13082,13676,14169,14298,14996,15349,15638,15832,16020,17429,19828,20454],
  SILVER:[88.8,96.0,93.0,93.0,100.1,99.0,94.8,88.2,86.3,87.7,92.0,84.8,88.7,89.7,99.1,102.9,93.4,95.6,86.6,89.0,89.4,93.7,98.2,103.3,101.8,96.6,96.4,109.3,108.9,108.7,111.2,112.2,113.1,110.3,115.8,114.7,110.9,112.0,120.2,137.8,151.3,153.2,154.5,137.9,141.0,158.9,156.5,154.1,156.2,160.3,162.1,153.4,156.3,169.8,180.6,183.7,204.6,243.2,256.6]
};

const assets = {
  BTC:    { name:"Bitcoin",  col:"#F7931A", cat:"crypto", curr: 'USD' },
  ETH:    { name:"Ethereum", col:"#627EEA", cat:"crypto", curr: 'USD' },
  BNB:    { name:"BNB",      col:"#F3BA2F", cat:"crypto", curr: 'USD' },
  NVIDIA: { name:"NVIDIA",   col:"#76B900", cat:"stock",  curr: 'USD' },
  AAPL:   { name:"Apple",    col:"#555555", cat:"stock",  curr: 'USD' },
  AMAZON: { name:"Amazon",   col:"#14B8A6", cat:"stock",  curr: 'USD' },
  GOOGLE: { name:"Google",   col:"#4285F4", cat:"stock",  curr: 'USD' },
  'S&P 500':{ name:"S&P 500",col:"#3B82F6", cat:"index", curr: 'JPY' },
  'æ—¥çµŒå¹³å‡':{ name:"æ—¥çµŒå¹³å‡",col:"#DC2626", cat:"index", curr: 'JPY' },
  GOLD:   { name:"Gold",     col:"#D4AF37", cat:"commodity", curr: 'JPY' },
  SILVER: { name:"Silver",   col:"#94A3B8", cat:"commodity", curr: 'JPY' }
};

// 2. ãƒ‡ãƒ¼ã‚¿å‡¦ç†
const jpyValues = {};
const INITIAL_INVESTMENT = 1000000;

Object.keys(assets).forEach(k => {
  let prices = [...raw[k]];
  
  if (assets[k].curr === 'JPY') {
     const initialPrice = prices[0] || 1;
     jpyValues[k] = prices.map(p => Math.round((p / initialPrice) * INITIAL_INVESTMENT));
  } else {
    // USDè³‡ç”£
    const initialPriceYen = (prices[0] || 1) * usdJpy[0];
    const baseUnits = INITIAL_INVESTMENT / initialPriceYen;

    jpyValues[k] = prices.map((price, i) => {
      let multiplier = 1;
      if (k === "NVIDIA") {
        if (i >= 41) multiplier = 40;
        else if (i >= 6) multiplier = 4;
      } else if (k === "GOOGLE") {
         if (i >= 18) multiplier = 20;
      } else if (k === "AMAZON") {
         if (i >= 17) multiplier = 20;
      }
      return Math.round(price * multiplier * baseUnits * usdJpy[i]);
    });
  }
});

// 3. DOMç”Ÿæˆ (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆé¸æŠå‡¦ç†ã‚’ä¿®æ­£)
const defaultCheckedAssets = ['BTC', 'NVIDIA', 'GOLD', 'S&P 500'];

Object.keys(assets).forEach(k => {
  const a = assets[k];
  const container = document.getElementById(a.cat + '-assets');
  
  // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã‚‹ã‹ã©ã†ã‹
  const isChecked = defaultCheckedAssets.includes(k) ? 'checked' : '';

  if (container) {
    container.innerHTML += `
      <div class="flex items-center">
        <input type="checkbox" id="cb-${k.replace(/\s/g, '')}" class="hidden asset-checkbox" 
               onchange="updateChart()" data-key="${k}" ${isChecked}
               style="--active-color: ${a.col}">
        <label for="cb-${k.replace(/\s/g, '')}" class="asset-label flex items-center cursor-pointer p-2 rounded-lg w-full transition hover:bg-slate-50 text-slate-600">
            <div class="check-circle w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center transition" style="border-color: ${a.col}">
                 <svg class="w-3 h-3 text-white transform scale-0 transition-transform" fill="currentColor" viewBox="0 0 20 20"><path d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"></path></svg>
            </div>
            <span class="font-bold">${a.name}</span>
        </label>
      </div>`;
  }
});

// 4. ãƒãƒ£ãƒ¼ãƒˆæç”»
let chart, currentPeriod = 'all';

function updateChart() {
  const checked = Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(c => c.dataset.key);
  
  let startIdx = 0;
  let endIdx = labels.length;
  
  if (currentPeriod !== 'all') {
    const yearStr = currentPeriod;
    startIdx = labels.findIndex(l => l.startsWith(yearStr));
    if(startIdx === -1) startIdx = 0;
    const nextYearIdx = labels.findIndex(l => l.startsWith(String(Number(yearStr) + 1)));
    endIdx = (nextYearIdx === -1) ? labels.length : nextYearIdx;
  }

  const subLabels = labels.slice(startIdx, endIdx);

  chart.data.labels = subLabels;
  chart.data.datasets = checked.map(key => {
    const dataSlice = jpyValues[key].slice(startIdx, endIdx);
    return {
      label: assets[key].name,
      data: dataSlice,
      borderColor: assets[key].col,
      backgroundColor: assets[key].col + '33',
      borderWidth: 2,
      pointRadius: 0,
      pointHitRadius: 10,
      tension: 0.2,
      assetKey: key
    };
  });
  
  chart.options.scales.x.time.unit = (currentPeriod === 'all') ? 'year' : 'month';
  chart.update();
}

// æœŸé–“ãƒœã‚¿ãƒ³
document.querySelectorAll('.year-btn').forEach(btn => {
  btn.addEventListener('click', function() {
    document.querySelectorAll('.year-btn').forEach(b => {
       b.classList.remove('active', 'bg-indigo-600', 'text-white', 'shadow-md');
       b.classList.add('bg-white', 'text-slate-600', 'hover:bg-slate-100');
    });
    
    this.classList.remove('bg-white', 'text-slate-600', 'hover:bg-slate-100');
    this.classList.add('active', 'bg-indigo-600', 'text-white', 'shadow-md');
    
    currentPeriod = this.dataset.period;
    updateChart();
  });
});

// ãƒãƒ£ãƒ¼ãƒˆåˆæœŸåŒ–
const ctx = document.getElementById('chart').getContext('2d');
chart = new Chart(ctx, {
  type: 'line',
  data: { labels: [], datasets: [] },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    interaction: { mode: 'index', intersect: false },
    layout: { padding: { right: 40 } },
    plugins: {
      legend: { 
          display: true, 
          position: 'top',
          labels: { usePointStyle: true, padding: 15, font: { weight: 'bold', size: 11 } },
          onClick: (e, legendItem, legend) => {
              const index = legendItem.datasetIndex;
              const ci = legend.chart;
              if (ci.isDatasetVisible(index)) {
                  ci.hide(index);
                  legendItem.hidden = true;
              } else {
                  ci.show(index);
                  legendItem.hidden = false;
              }
          }
      },
      tooltip: {
        callbacks: {
          label: function(context) {
            const val = context.raw;
            const diff = val - 1000000;
            const sign = diff >= 0 ? '+' : '';
            const percent = ((val / 1000000 - 1) * 100).toFixed(1);
            const yenFmt = new Intl.NumberFormat('ja-JP').format(Math.round(val));
            return `${context.dataset.label}: ${yenFmt}å†† (${sign}${percent}%)`;
          }
        }
      },
      datalabels: {
        align: 'right',
        anchor: 'end',
        color: c => c.dataset.borderColor,
        font: { weight: 'bold', size: 10 },
        formatter: (v, c) => {
             return c.dataIndex === c.dataset.data.length - 1 ? c.dataset.label : null;
        },
        display: 'auto',
        clip: false
      }
    },
    scales: {
      x: { 
          type: 'time',
          time: { unit: 'year', displayFormats: { 'year': 'yyyyå¹´', 'month': 'Mæœˆ'} },
          grid: { color: '#e2e8f0' }, 
          ticks: { color: '#475569', font: {weight: 'bold', size: 10} } 
      },
      y: {
        grid: { color: '#e2e8f0' },
        title: { display: true, text: 'è©•ä¾¡é¡ (å††)', font: { weight: 'bold' } },
        ticks: { 
            callback: v => (v/10000).toLocaleString() + 'ä¸‡å††',
            color: '#475569',
            font: { size: 10 }
        }
      }
    }
  }
});

window.onload = updateChart;
</script>
</body>
</html>
